import{ah as l,o as T,M as X,r as $,B as _e,j as ce,O as t,U as e,u as c,D as st,S as q,I as Ae,ay as ge,az as ke,a as o,Z as ae,c as G,a7 as ve,F as fe,e as J,T as Z,Y as Ve,W as nt,J as ee,R as de,a8 as lt,P as Ue,V as Fe,a2 as rt,ad as Ne,at as it}from"./@vue--DJJJL3C.js";import{d as me,s as be,c as dt}from"./pinia-B8t-7oV-.js";import{s as ct}from"./pinia-plugin-persistedstate-RV7uh3T-.js";/* empty css                    */import{E as V,a as ut,b as pe,c as pt,d as Be,e as Me,f as xe,g as Se,i as ft,z as _t}from"./element-plus-_-vexHBn.js";import{Q as mt,R as ht,S as vt,T as gt,U as kt,g as yt,M as wt,V as xt,W as bt}from"./@element-plus-lfDKxIrU.js";import{u as Te,c as Ct,a as St}from"./vue-router-BSeRJAFm.js";import{a as qe}from"./axios-B4uVmeYG.js";import{d as We}from"./dayjs-Ct2Knyoi.js";import{g as he,d as It,i as Ie}from"./echarts-JJLx8KTS.js";import{u as $e,T as ze}from"./@vueuse-DALFKB0l.js";import"./lodash-es-CiJSjksT.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DgZhbb76.js";import"./tslib-BDyQ-Jie.js";import"./zrender-CDo53BfZ.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))y(g);new MutationObserver(g=>{for(const f of g)if(f.type==="childList")for(const C of f.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&y(C)}).observe(document,{childList:!0,subtree:!0});function k(g){const f={};return g.integrity&&(f.integrity=g.integrity),g.referrerPolicy&&(f.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?f.credentials="include":g.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function y(g){if(g.ep)return;g.ep=!0;const f=k(g);fetch(g.href,f)}})();const re=(r,d)=>{const k=r.__vccOpts||r;for(const[y,g]of d)k[y]=g;return k},$t={};function zt(r,d){const k=l("router-view");return T(),X(k)}const At=re($t,[["render",zt]]),B=me("token",{state:()=>({token:$("")}),actions:{setToken(r){this.token=r},removeToken(){this.token=""}},persist:!0}),Ce=me("layout",{state:()=>({isCollapse:!0}),actions:{toggleCollapse(){this.isCollapse=!this.isCollapse}}}),Ye=me("hitokoto",{state:()=>({text:"",from:"",url:"#"}),actions:{fetchData(){qe.get("https://v1.hitokoto.cn").then(({data:r})=>{this.text=r.hitokoto,this.from=r.from,this.url=`https://hitokoto.cn/?uuid=${r.uuid}`}).catch(r=>{console.error(r),this.text="加载失败",this.from="",this.url="#"})}}}),Ge=async(r,d)=>{try{const k=r.token;console.log(k);const y=await d.get("/user/userInfo",{headers:{Authorization:k}});if(y.data.code)throw console.error("获取用户信息失败:",y.data.message),new Error(y.data.message);return console.log("获取用户信息成功:",y.data.info),y.data.info}catch(k){throw console.error("请求用户信息出错:",k),k}},Pe=r=>(ge("data-v-0dbb21df"),r=r(),ke(),r),Vt=Pe(()=>o("div",{class:"flex-grow"},null,-1)),Tt=Pe(()=>o("span",null,"设置",-1)),Pt=Pe(()=>o("span",null,"登出",-1)),Dt=Pe(()=>o("span",null,"首页",-1)),Ut={__name:"index",setup(r){const d=Ce(),{isCollapse:k}=be(d),{toggleCollapse:y}=d,g=_e("axios"),f=$(null),C=Te(),W=B(),M=()=>{W.removeToken(),console.log("清除后的 token:",W.token),V({type:"success",message:"已退出登录"});const u=Ye();u.intervalId&&clearInterval(u.intervalId),u.intervalId=null,C.push("/login")},i=(u,D)=>{console.log(u,D)},j=(u,D)=>{console.log(u,D)},x=(u,D)=>{console.log(u,D)};return ce(async()=>{const u=B();try{const D=await Ge(u,g);f.value=D.user_pic}catch(D){console.error("获取用户信息失败:",D)}}),(u,D)=>{const Y=l("ElementPlus"),E=l("el-icon"),P=l("el-menu-item"),b=l("el-avatar"),h=l("User"),_=l("el-sub-menu"),U=l("el-menu"),K=l("el-header"),Q=l("el-button"),F=l("Calendar"),A=l("Histogram"),oe=l("el-aside"),se=l("router-view"),z=l("el-main"),ne=l("el-container");return T(),X(ne,{class:"animate__animated animate__fadeIn"},{default:t(()=>[e(K,{style:{height:"60px","text-align":"right","font-size":"12px"}},{default:t(()=>[e(U,{"default-active":u.activeIndex,mode:"horizontal",ellipsis:!1,onSelect:i,class:"nav-bar",router:"true"},{default:t(()=>[e(P,null,{default:t(()=>[e(E,{size:"100"},{default:t(()=>[e(Y)]),_:1})]),_:1}),Vt,e(_,{teleported:!0},{title:t(()=>[e(b,{src:f.value},null,8,["src"])]),default:t(()=>[e(P,{index:"settings"},{default:t(()=>[e(E,null,{default:t(()=>[e(c(mt))]),_:1}),Tt]),_:1}),e(P,{onClick:M},{default:t(()=>[e(E,null,{default:t(()=>[e(h)]),_:1}),Pt]),_:1})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(ne,null,{default:t(()=>[e(oe,{width:c(k)?"64px":"250px",collapse:c(k),style:{height:"calc(100vh - 60px)","overflow-y":"auto","margin-top":"60px",position:"fixed"}},{default:t(()=>[e(Q,{class:"collapse-btn",onClick:c(y),modelValue:c(k),"onUpdate:modelValue":D[0]||(D[0]=le=>st(k)?k.value=le:null)},{default:t(()=>[e(E,{size:"18"},{default:t(()=>[e(c(ht))]),_:1})]),_:1},8,["onClick","modelValue"]),e(U,{"default-active":"2",class:"sidebar-collaspe",collapse:c(k),onOpen:j,onClose:x,router:"true"},{default:t(()=>[e(P,{index:"dashboard"},{title:t(()=>[Dt]),default:t(()=>[e(E,null,{default:t(()=>[e(F)]),_:1})]),_:1}),e(P,{index:"plan"},{title:t(()=>[q("计划")]),default:t(()=>[e(E,null,{default:t(()=>[e(c(vt))]),_:1})]),_:1}),e(P,{index:"data"},{title:t(()=>[q("数据")]),default:t(()=>[e(E,null,{default:t(()=>[e(A)]),_:1})]),_:1}),e(P,{index:"settings"},{title:t(()=>[q("用户中心")]),default:t(()=>[e(E,null,{default:t(()=>[e(h)]),_:1})]),_:1})]),_:1},8,["collapse"])]),_:1},8,["width","collapse"]),e(z,{class:Ae(c(k)?"main-collapsed":"main-expanded")},{default:t(()=>[e(se)]),_:1},8,["class"])]),_:1})]),_:1})}}},Ft=re(Ut,[["__scopeId","data-v-0dbb21df"]]),Re=r=>(ge("data-v-acc1ea6d"),r=r(),ke(),r),Rt={class:"loginwrapper"},Et=Re(()=>o("div",{class:"title animate__animated animate__bounceInLeft animate__delay-1s"}," DEMO ",-1)),Lt=Re(()=>o("div",{class:"description animate__animated animate__fadeInDown animate__delay-2s"}," 轻量级,多样化 ToDoList 系统 ",-1)),Ot={class:"bg-bubbles"},Nt=Re(()=>o("div",{class:"font-bold text-3xl mb-4"},"登录",-1)),Bt={class:"register"},Mt={__name:"login",setup(r){const d=B(),k=Te(),y=_e("axios"),g=$(null),f=ae({userId:"3131492575@qq.com",password:"123456"}),M=ae({userId:[{validator:(j,x,u)=>{if(x==="")u(new Error("请输入对应的账户"));else{if(f.checkPass!==""){if(!g.value)return;g.value.validateField("checkPass")}u()}},trigger:"blur"}],password:[{validator:(j,x,u)=>{if(x==="")u(new Error("请输入对应的密码"));else{if(f.checkPass!==""){if(!g.value)return;g.value.validateField("checkPass")}u()}},trigger:"blur"}]}),i=j=>{j&&j.validate(x=>{x?y.post("/user/login",f).then(u=>{console.log(u.data.code),u.data.code?(V({type:"error",message:"登录失败"}),V({type:"error",message:"请确保你输入了正确的账户与密码!"}),console.log("登录失败:",u)):(V({type:"success",message:"登录成功"}),console.log("登录成功:",u.data),console.log("当前账户的token：",u.data.info),d.setToken(u.data.info),k.push("/"))}).catch(u=>{console.error("登录失败:",u)}):console.log("请确保你输入了正确的账户与密码!")})};return(j,x)=>{const u=l("el-col"),D=l("el-input"),Y=l("el-form-item"),E=l("el-button"),P=l("el-form"),b=l("router-link"),h=l("el-row");return T(),X(h,{class:"mainframework animate__animated animate__fadeIn"},{default:t(()=>[e(u,{lg:16,md:12,class:"leftframework"},{default:t(()=>[o("div",Rt,[Et,Lt,o("ul",Ot,[(T(),G(fe,null,ve(10,_=>o("li",{key:_})),64))])])]),_:1}),e(u,{lg:8,md:12,class:"rightframework"},{default:t(()=>[Nt,e(P,{ref_key:"loginFormRef",ref:g,model:f,rules:M,class:"w-[250px]","label-width":"auto"},{default:t(()=>[e(Y,{prop:"userId"},{default:t(()=>[e(D,{modelValue:f.userId,"onUpdate:modelValue":x[0]||(x[0]=_=>f.userId=_),placeholder:"用户名","prefix-icon":c(gt)},null,8,["modelValue","prefix-icon"])]),_:1}),e(Y,{prop:"password"},{default:t(()=>[e(D,{modelValue:f.password,"onUpdate:modelValue":x[1]||(x[1]=_=>f.password=_),"prefix-icon":c(kt),type:"password",placeholder:"密码"},null,8,["modelValue","prefix-icon"])]),_:1}),e(Y,null,{default:t(()=>[e(E,{type:"primary",onClick:x[2]||(x[2]=_=>i(g.value)),class:"w-[250px]"},{default:t(()=>[q("登录")]),_:1})]),_:1})]),_:1},8,["model","rules"]),o("div",Bt,[e(b,{to:"/register"},{default:t(()=>[q("注册")]),_:1})])]),_:1})]),_:1})}}},Wt=re(Mt,[["__scopeId","data-v-acc1ea6d"]]),jt={};function Kt(r,d){const k=l("el-button"),y=l("el-result"),g=l("el-col");return T(),X(g,{offset:9,sm:12,lg:6},{default:t(()=>[e(y,{icon:"warning",title:"404","sub-title":"PAGE NOT FOUND"},{extra:t(()=>[e(k,{type:"primary",onClick:d[0]||(d[0]=f=>r.$router.push("/"))},{default:t(()=>[q("Back")]),_:1})]),_:1})]),_:1})}const Ht=re(jt,[["render",Kt]]),De=r=>(ge("data-v-fa665229"),r=r(),ke(),r),qt={class:"wrapper"},Yt={class:"text-center my-5"},Gt=De(()=>o("div",{class:"text-2xl font-bold mb-xs"},"创建您的账户",-1)),Qt=De(()=>o("span",{class:"text-sm text-gray-400"},"已经有账户了？",-1)),Jt={class:"login"},Xt=De(()=>o("div",{class:"text-xs text-gray-400 text-center flex items-center justify-center space-x-3 mb-1"},[o("span",{class:"h-[1px] w-40 bg-gray-200",style:{display:"inline-block"}}),o("span",null,"OR"),o("span",{class:"h-[1px] w-40 bg-gray-200",style:{display:"inline-block"}})],-1)),Zt={class:"flex flex-col items-center justify-center"},eo=De(()=>o("span",null," ",-1)),to={class:"square-bg-bubbles"},oo={__name:"register",setup(r){const d=_e("axios"),k=$(0),y=$(!0),g=$(!1),f=Te(),C=$(null),W=()=>{if(!y.value){V({type:"info",message:"请稍候，正在冷却中..."});return}if(!u.userId){V({type:"error",message:"请输入邮箱地址！"});return}console.log("发送验证码给:",u.userId),d.post(`/user/getVerificationCode?userId=${encodeURIComponent(u.userId)}`).then(P=>{if(console.log(P.data.code),P.data.code===1)throw new Error(P.data.message);k.value=120,y.value=!1;const b=setInterval(()=>{k.value--,k.value<=0&&(clearInterval(b),y.value=!0)},1e3);V({type:"success",message:"验证码已发送，请查收！"})}).catch(P=>{V({type:"error",message:`发送失败: ${P.message}`})})},M=(P,b,h)=>{if(b==="")h(new Error("请输入邮箱"));else{if(u.checkPass!==""){if(!C.value)return;C.value.validateField("checkPass")}h()}},i=(P,b,h)=>{if(b==="")h(new Error("请输入验证码"));else{if(u.checkPass!==""){if(!C.value)return;C.value.validateField("checkPass")}h()}},j=(P,b,h)=>{if(b==="")h(new Error("请输入密码"));else{if(u.checkPass!==""){if(!C.value)return;C.value.validateField("checkPass")}h()}},x=(P,b,h)=>{b===""?h(new Error("请再次输入密码")):b!==u.pass?h(new Error("请确保两次输入的密码相同")):h()},u=ae({userId:"",verifyCode:"",pass:"",checkPass:""}),D=ae({userId:[{validator:M,trigger:"blur"}],verifyCode:[{validator:i,trigger:"blur"}],pass:[{validator:j,trigger:"blur"}],checkPass:[{validator:x,trigger:"blur"}]});J(()=>C.value?C.value.validate().catch(()=>!1):!1);const Y=async P=>{if(!P){V({type:"error",message:"表单提交错误，请刷新页面重试。"});return}if(!g.value){V({type:"error",message:"请同意服务条款"});return}await P.validate().catch(()=>!1)?(console.log("submit!"),d.post("/user/register",u).then(h=>{console.log(h.data),h.data.code?(console.log(h.data.message),V({type:"error",message:"请确保验证码填写正确"})):(V({type:"success",message:"注册成功！"}),f.push("/login"))}).catch(h=>{V({type:"error",message:`注册失败: ${h.message}`})})):(console.log("error submit!"),V({type:"error",message:"请确保注册信息完整无误"}))},E=()=>{ut.confirm("<font size=4 color=black><strong>DEMO 服务条款</strong></font><br>    <font size=3>关于我们</font><br>    <font size=3>1. 介绍</font><br>    欢迎使用我们的任务管理系统（以下简称“本系统”）。在您使用本系统之前，请仔细阅读本服务条款。通过访问或使用本系统，您同意受这些条款的约束。<br>    <font size=3>2. 服务</font><br>    本系统提供任务管理、日程安排、提醒设置等功能，旨在帮助用户高效管理日常任务。<br>    <font size=3>3. 用户账户</font><br>    为使用本系统的全部功能，用户需要注册账户。用户必须提供真实、准确、最新和完整的信息。账户安全由用户负责。<br>    <font size=3>4. 使用规范</font><br>    用户在使用本系统时，必须遵守所有适用的法律法规。用户不得利用本系统进行任何非法或未经授权的活动。<br>    <font size=3>5. 内容所有权</font><br>    本系统包含的所有内容，包括但不限于文本、图像、用户界面、视觉界面、信息内容以及软件编码，其知识产权归本公司所有。<br>    <font size=3>6. 第三方链接</font><br>    本系统可能包含指向第三方网站或服务的链接，这些链接仅为方便用户而提供。使用第三方服务须遵守第三方的条款和政策。<br>    <font size=3>7. 联系我们</font><br>    如有任何问题或建议，请与我们联系。<br>","服务条款",{confirmButtonText:"我同意",cancelButtonText:"关闭",showcancelbutton:!0,dangerouslyUseHTMLString:!0,customClass:"message-box"}).catch(()=>{V({type:"info",message:"已取消"})})};return(P,b)=>{const h=l("router-link"),_=l("el-input"),U=l("el-form-item"),K=l("el-button"),Q=l("el-checkbox"),F=l("el-form"),A=l("el-card"),oe=l("el-col"),se=l("el-row");return T(),G("div",qt,[e(se,{style:{width:"450px",height:"auto"}},{default:t(()=>[e(oe,{style:{"z-index":"2"},xs:24,sm:24,md:24,lg:24,class:"animate__animated animate__fadeIn"},{default:t(()=>[e(A,{class:"justify-center",style:{"border-radius":"10px"},shadow:"always"},{default:t(()=>[o("div",Yt,[Gt,Qt,o("span",Jt,[e(h,{to:"/login"},{default:t(()=>[q("在此登入")]),_:1})])]),Xt,o("div",Zt,[e(F,{ref_key:"registerFormRef",ref:C,style:{"max-width":"600px"},model:u,"status-icon":"",rules:D,"label-width":"200px","label-position":"top",class:"register_form"},{default:t(()=>[e(U,{label:"邮箱",prop:"userId"},{default:t(()=>[e(_,{size:"large",modelValue:u.userId,"onUpdate:modelValue":b[0]||(b[0]=z=>u.userId=z),type:"text",autocomplete:"off",placeholder:"请正确输入你的邮箱",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(U,{label:"验证码",prop:"verifyCode"},{default:t(()=>[e(_,{size:"large",modelValue:u.verifyCode,"onUpdate:modelValue":b[3]||(b[3]=z=>u.verifyCode=z),type:"text",autocomplete:"off",placeholder:"请输入你的验证码",class:"inputbox-varify"},{append:t(()=>[e(K,{color:"#2283e5",modelValue:u.verifyCode,"onUpdate:modelValue":b[1]||(b[1]=z=>u.verifyCode=z),onClick:b[2]||(b[2]=z=>W(C.value)),class:"varify-button",disabled:!y.value},{default:t(()=>[q(Z(y.value?"获取":` ${k.value} s`),1)]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue"])]),_:1}),e(U,{label:"密码",prop:"pass"},{default:t(()=>[e(_,{size:"large",modelValue:u.pass,"onUpdate:modelValue":b[4]||(b[4]=z=>u.pass=z),type:"password",autocomplete:"off",placeholder:"请正确输入你的密码",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(U,{label:"重复密码",prop:"checkPass"},{default:t(()=>[e(_,{size:"large",modelValue:u.checkPass,"onUpdate:modelValue":b[5]||(b[5]=z=>u.checkPass=z),type:"password",autocomplete:"off",placeholder:"请再次正确输入你的密码",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(U,null,{default:t(()=>[e(Q,{modelValue:g.value,"onUpdate:modelValue":b[6]||(b[6]=z=>g.value=z),label:"我同意",size:"large",style:{"margin-top":"0.95px"}},null,8,["modelValue"]),eo,o("span",{class:"text-blue-500",onClick:E,style:{cursor:"pointer"}},"服务条款")]),_:1}),e(U,null,{default:t(()=>[e(K,{type:"primary",onClick:b[7]||(b[7]=z=>Y(C.value)),class:"text-sm h-[40px] w-[350px] mt-2 mb-8",color:"#2283e5"},{default:t(()=>[q(" 创建账户 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1})]),_:1})]),_:1}),o("ul",to,[(T(),G(fe,null,ve(10,z=>o("li",{key:z})),64))])])}}},ao=re(oo,[["__scopeId","data-v-fa665229"]]),Qe=async(r,d)=>{try{const k=r.token;console.log(k);const y=await d.get("/task/statistics",{headers:{Authorization:k}});if(y.data.code)throw console.error("获取数据失败:",y.data.message),new Error(y.data.message);return console.log("获取数据成功:",y.data),y.data}catch(k){throw console.error("请求数据出错:",k),k}},ue=r=>(ge("data-v-3b7bb6ec"),r=r(),ke(),r),so={class:"animate__animated animate__bounceInLeft"},no=ue(()=>o("div",{class:"main-title"},"我的一天",-1)),lo=ue(()=>o("div",{class:"card-header"},[o("span",null,"建议")],-1)),ro={style:{display:"flex","align-items":"center"}},io={style:{"font-size":"16px"}},co={class:"stat-content"},uo=ue(()=>o("div",{class:"stat-title",style:{"margin-bottom":"1.2%"}},"提醒",-1)),po={style:{display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1.2%"}},fo={style:{flex:"1","text-align":"center"}},_o={style:{display:"flex","flex-direction":"column","align-items":"center","margin-top":"3%"}},mo={style:{display:"flex","align-items":"center","margin-bottom":"5%","font-size":"16px"}},ho={class:"countdown-footer"},vo={style:{flex:"1","text-align":"center","margin-top":"0.8%"}},go=ue(()=>o("div",null,"未完成任务数",-1)),ko={style:{flex:"1","text-align":"center","margin-top":"0.8%"}},yo=ue(()=>o("div",{style:{"margin-bottom":"15%"}},"未完成任务平均进度",-1)),wo=ue(()=>o("div",{id:"hitokoto-title"},"一言",-1)),xo={id:"hitokoto-text"},bo=["href"],Co={key:0,id:"hitokoto-from",class:"flex flex-col"},So=ue(()=>o("div",{class:"card-header"},[o("span",null,"建议")],-1)),Io={style:{display:"flex","align-items":"center"}},$o={style:{"font-size":"16px"}},zo=ue(()=>o("div",{id:"hitokoto-title"},"一言",-1)),Ao={id:"hitokoto-text"},Vo=["href"],To={key:0,id:"hitokoto-from",class:"flex flex-col"},Po={__name:"dashboard",setup(r){const d=_e("axios"),k=Ce(),{isCollapse:y}=be(k),g=B();g.token;const f=Ye(),C=ae([]);$(We().add(1,"month").startOf("month"));const W=$(""),M=$({});ce(async()=>{f.text||f.fetchData();const h=await Qe(g,d);M.value=h,P(),b()});const i=$(window.innerWidth),j=()=>{i.value=window.innerWidth,y.value=window.innerWidth<1024};ce(()=>{window.addEventListener("resize",j)}),Ve(()=>{window.removeEventListener("resize",j)});const x=J(()=>i.value>=1024),u=J(()=>({width:i.value>=1024?"100%":"160%",marginRight:"20px"})),D=J(()=>({width:"100%",marginRight:"20px"})),Y=J(()=>({width:i.value>=1024?"100%":"160%",marginRight:"20px"})),E=J(()=>({width:"100%",marginRight:"20px"})),P=async()=>{const _=B().token;try{d.get("/task/getAllOrderedTasks",{headers:{Authorization:_}}).then(U=>{C.splice(0,C.length,...U.data.info),console.log(C)})}catch{}},b=async()=>{const _=B().token;try{d.get("/task/getEndtime",{headers:{Authorization:_}}).then(U=>{console.log(U.data.info),W.value=new Date(U.data.info)})}catch{}};return(h,_)=>{const U=l("el-calendar"),K=l("el-card"),Q=l("el-col"),F=l("el-scrollbar"),A=l("el-row"),oe=l("el-icon"),se=l("el-countdown");return T(),X(nt,{name:"custom-animations"},{default:t(()=>[o("div",so,[e(A,{gutter:30},{default:t(()=>[e(Q,{span:15},{default:t(()=>[e(K,{style:ee(u.value),class:"calendar"},{default:t(()=>[no,e(U,null,{"date-cell":t(({data:z})=>[o("p",{class:Ae(z.isSelected?"is-selected":"")},Z(z.day.split("-").slice(2).join("-"))+" "+Z(z.isSelected?"✔️":""),3)]),_:1})]),_:1},8,["style"])]),_:1}),e(Q,{span:9},{default:t(()=>[x.value?(T(),X(K,{key:0,class:"suggestion",style:ee(D.value),collapse:c(y)},{header:t(()=>[lo]),default:t(()=>[e(F,{style:{"max-height":"52.5vh","overflow-y":"auto"}},{default:t(()=>[(T(!0),G(fe,null,ve(C,z=>(T(),G("div",{key:z.id,class:"w-[100%] cursor-pointer",onClick:_[0]||(_[0]=ne=>h.$router.push("/plan"))},[o("div",ro,[e(K,{class:"task-card",shadow:"hover",style:{width:"200%"}},{default:t(()=>[o("div",io,Z(z.task_name),1)]),_:2},1024)])]))),128))]),_:1})]),_:1},8,["style","collapse"])):de("",!0)]),_:1})]),_:1}),e(A,{gutter:30},{default:t(()=>[e(Q,{span:15},{default:t(()=>[e(K,{class:"data-stat",style:ee(Y.value),collapse:c(y)},{default:t(()=>[o("div",co,[uo,o("div",po,[o("div",fo,[o("div",_o,[o("div",mo,[e(oe,{style:{"margin-right":"4px"},size:18},{default:t(()=>[e(c(yt))]),_:1}),q(" 距最近未完成任务的截至时间还剩 ")]),e(se,{format:"DD [days] HH:mm:ss",value:W.value,style:{"margin-bottom":"5%"}},null,8,["value"]),o("div",ho,Z(c(We)(W.value).format("YYYY-MM-DD")),1)])]),o("div",vo,[go,o("div",null,Z(M.value.allUnfinishedTasksCount),1)]),o("div",ko,[yo,o("div",null,Z((M.value.avgProcessOfUnfinishedTasks*100).toFixed(2))+" % ",1)])])])]),_:1},8,["style","collapse"])]),_:1}),e(Q,{span:9},{default:t(()=>[x.value?(T(),X(K,{key:0,class:Ae(["hitokoto-part",c(y)?"hitokoto-collapsed":"hitokoto-expanded"]),collapse:c(y),style:ee(E.value)},{default:t(()=>[wo,o("div",xo,[o("a",{href:c(f).url},Z(c(f).text),9,bo)]),c(f).from?(T(),G("div",Co," —— 《"+Z(c(f).from)+"》 ",1)):de("",!0)]),_:1},8,["class","collapse","style"])):de("",!0)]),_:1})]),_:1}),e(A,{gutter:30,span:16},{default:t(()=>[e(Q,{span:23,style:{marginRight:"auto"}},{default:t(()=>[x.value?de("",!0):(T(),X(K,{key:0,class:"suggestion1",style:ee(D.value),collapse:c(y)},{header:t(()=>[So]),default:t(()=>[e(F,{style:{"max-height":"52.5vh","overflow-y":"auto"}},{default:t(()=>[(T(!0),G(fe,null,ve(C,z=>(T(),G("div",{key:z.id,class:"w-[100%] cursor-pointer",onClick:_[1]||(_[1]=ne=>h.$router.push("/plan"))},[o("div",Io,[e(K,{class:"task-card",shadow:"hover",style:{width:"200%"}},{default:t(()=>[o("div",$o,Z(z.task_name),1)]),_:2},1024)])]))),128))]),_:1})]),_:1},8,["style","collapse"]))]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(Q,{span:23},{default:t(()=>[x.value?de("",!0):(T(),X(K,{key:0,class:Ae(["hitokoto-part",c(y)?"hitokoto-collapsed1":"hitokoto-expanded1"]),collapse:c(y),style:ee(E.value)},{default:t(()=>[zo,o("div",Ao,[o("a",{href:c(f).url},Z(c(f).text),9,Vo)]),c(f).from?(T(),G("div",To," —— 《"+Z(c(f).from)+"》 ",1)):de("",!0)]),_:1},8,["class","collapse","style"]))]),_:1})]),_:1})])]),_:1})}}},Do=re(Po,[["__scopeId","data-v-3b7bb6ec"]]),Uo=me("steps",{state:()=>({stepsStatus:{}}),actions:{setStepStatus(r,d){this.stepsStatus[r]=d}},persist:!0}),Fo=me("taskCheck",{state:()=>({taskStatus:{}}),actions:{setTaskStatus(r,d){this.taskStatus[r]=d}},persist:!0}),Ro=me("task",{state:()=>({tasks:[],stars:{}}),actions:{toggleStar(r){this.tasks.includes(r)||(this.tasks.push(r),this.stars[r]=!1),this.stars[r]=!this.stars[r]}},persist:!0}),Eo=me("taskSelect",{state:()=>{},actions:{setKind(r){this.kind=r}},persist:!0}),Lo=r=>(ge("data-v-86ed5f30"),r=r(),ke(),r),Oo={class:"input-button-wrapper"},No={class:"cards-wrapper"},Bo={class:"button-wrapper"},Mo={style:{display:"flex","align-items":"center"}},Wo={style:{"font-size":"16px"}},jo={class:"button-wrapper"},Ko=Lo(()=>o("span",{style:{"margin-left":"8px"}},"下一步",-1)),Ho={__name:"plan",setup(r){const d=_e("axios"),k=Ce(),y=Uo(),g=Ro(),f=Fo(),C=Eo(),{isCollapse:W}=be(k),M=$(""),i=ae([]),j=()=>{x.value=window.innerWidth,x.value<950?W.value=!0:x.value>=950&&x.value<=1e3&&(W.value=!1)},x=$(window.innerWidth),u=J(()=>x.value>=950);ce(()=>{window.addEventListener("resize",j)}),Ve(()=>{window.removeEventListener("resize",j)});const D=J(()=>x.value<950?"450%":!_.value&&!h.value?"400%":(_.value&&!h.value,"100%")),Y=J(()=>!_.value&&!h.value?"0px":_.value&&!h.value?"230%":"100%"),E=J(()=>!_.value&&!h.value||_.value&&!h.value?"0px":"100%"),P=J(()=>!_.value&&!h.value?"0px":"100%"),b=J(()=>x.value<1024?"50%":"75%"),h=$(!1),_=$(!0),U=a=>{_.value=!0;const p=B().token;switch(a){case 1:d.get("/task/getTodayTask",{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v]);C.setKind(1)});break;case 2:d.get("/task/getAllTasks",{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v]);C.setKind(2)});break;case 3:d.get("/task/getAllUnfinishedTasks",{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v]);C.setKind(3)});break;case 4:d.get("/task/getAllFinishedTasks",{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v]);C.setKind(4)});break;case 5:d.get("/task/getAllFavourTasks",{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v]);C.setKind(5)});break}},K=async()=>{i.splice(0,i.length);const n=B().token;console.log(n);try{await d.post("/task/add",i,{headers:{Authorization:n}}).then(p=>{let s=[];s=p.data.info;for(let m=0;m<s.length;m++)i.push(s[m]);console.log(i)})}catch{}},Q=async(a,n)=>{const s=B().token;console.log(s),i.splice(0,i.length);try{await d.put(`/task/deleteTask?id=${encodeURIComponent(a.id)}`,{},{headers:{Authorization:s}}).then(m=>{switch(n){case 1:d.get("/task/getTodayTask",{headers:{Authorization:s}}).then(v=>{console.log(v.data.info);let O=[];O=v.data.info;for(let S=0;S<O.length;S++)i.push(O[S])});break;case 2:d.get("/task/getAllTasks",{headers:{Authorization:s}}).then(v=>{console.log(v.data.info);let O=[];O=v.data.info,i.splice(0,i.length);for(let S=0;S<O.length;S++)i.push(O[S])});break;case 3:d.get("/task/getAllUnfinishedTasks",{headers:{Authorization:s}}).then(v=>{console.log(v.data.info);let O=[];O=v.data.info,i.splice(0,i.length);for(let S=0;S<O.length;S++)i.push(O[S])});break;case 4:d.get("/task/getAllFinishedTasks",{headers:{Authorization:s}}).then(v=>{console.log(v.data.info);let O=[];O=v.data.info,i.splice(0,i.length);for(let S=0;S<O.length;S++)i.push(O[S])});break;case 5:d.get("/task/getAllFavourTasks",{headers:{Authorization:s}}).then(v=>{console.log(v.data.info);let O=[];O=v.data.info,i.splice(0,i.length);for(let S=0;S<O.length;S++)i.push(O[S])});break;default:break}})}catch(m){console.error("Failed to delete task",m)}},F=$(null),A=ae({values:[]}),oe=async a=>{h.value=!0,F.value=a,console.log(F.value);const p=B().token;console.log(p);try{await d.post("/step/getAllStep",{task_id:a.id},{headers:{Authorization:p}}).then(s=>{A.values.splice(0,A.values.length,...s.data.info),console.log(A.values)})}catch{}},se=async()=>{const n=B().token;console.log(n),console.log(A.values),console.log(F.value);try{await d.put("/task/updateTask",F.value,{headers:{Authorization:n}}).then(p=>{if(console.log(p.data),p.data.code)console.error("Failed to update task on server: ",p.data.message);else{const s=i.findIndex(m=>m.id===F.value.id);s!==-1&&(i[s]={...i[s],...F.value}),console.log("Task updated successfully in the local list.")}})}catch{}},z=async()=>{const n=B().token;console.log(n);try{await d.put("/step/updateStep",A.values,{headers:{Authorization:n}}).then(p=>{console.log(p.data)})}catch{}},ne=async()=>{const n=B().token;console.log(n);const p={content:""};try{const s=await d.post(`/step/addNewStep?task_id=${encodeURIComponent(F.value.id)}`,p,{headers:{Authorization:n}});console.log("Step added response:",s.data);const m=await d.post("/step/getAllStep",{task_id:F.value.id},{headers:{Authorization:n}});m.data.info&&(A.values.splice(0,A.values.length,...m.data.info),console.log("Updated steps:",A.values))}catch(s){console.error("Error adding new step:",s)}},le=async a=>{const p=B().token;console.log(p),console.log(a.id);try{await d.put(`/step/deleteStep?step_id=${encodeURIComponent(a.id)}`,{},{headers:{Authorization:p}}).then(s=>{A.values.splice(0,A.values.length,...s.data.info),console.log(A)})}catch{}},L=async a=>{const p=B().token;try{const s=await d.put(`/step/finishStep?step_id=${encodeURIComponent(a.id)}`,{},{headers:{Authorization:p}});A.values.splice(0,A.values.length,...s.data.info),console.log(A.values)}catch(s){console.error("Failed to update step status:",s)}},w=async a=>{const p=B().token;try{const s=await d.put(`/task/favourTask?task_id=${encodeURIComponent(a.id)}`,{},{headers:{Authorization:p}});console.log(s.data),g.toggleStar(a.id)}catch(s){console.error("Failed to update task favour status:",s)}},N=async a=>{const p=B().token;try{const s=await d.put(`/task/finishTask?task_id=${encodeURIComponent(a.id)}`,{},{headers:{Authorization:p}});A.values.splice(0,A.values.length,...s.data.info),console.log(A.values)}catch(s){console.error("Failed to update task favour status:",s)}},H=async a=>{const p=B().token;console.log(a);try{d.post("/task/search",{taskName:a},{headers:{Authorization:p}}).then(s=>{console.log(s.data.info);let m=[];m=s.data.info,i.splice(0,i.length);for(let v=0;v<m.length;v++)i.push(m[v])})}catch{}},we=[{text:"今日",value:new Date},{text:"明日",value:()=>{const a=new Date;return a.setDate(a.getDate()+1),a}},{text:"一周后",value:()=>{const a=new Date;return a.setDate(a.getDate()+7),a}}],R=async a=>{const p=B().token;await oe(a);try{await d.put("/task/updateTask",a,{headers:{Authorization:p}}).then(s=>{if(console.log(s.data),s.data.code)console.error("Failed to update task on server: ",s.data.message);else{const m=i.findIndex(v=>v.id===F.value.id);m!==-1&&(i[m]={...i[m],...F.value}),console.log("Task updated successfully in the local list.")}})}catch{}};return(a,n)=>{const p=l("el-icon"),s=l("el-input"),m=l("el-card"),v=l("el-collapse"),O=l("el-scrollbar"),S=l("el-col"),Ee=l("Plus"),Le=l("CloseBold"),Ze=l("el-empty"),Oe=l("el-checkbox"),et=l("StarFilled"),tt=l("Star"),ot=l("el-collapse-item"),at=l("el-row");return T(),X(at,{gutter:"30",class:"full-height"},{default:t(()=>[e(S,{span:6,class:"full-height"},{default:t(()=>[e(m,{style:ee({width:D.value,height:"100%"}),class:"full-height animate__animated animate__fadeInLeft"},{default:t(()=>[e(O,{class:"content"},{default:t(()=>[e(v,{modelValue:a.activeNames,"onUpdate:modelValue":n[7]||(n[7]=I=>a.activeNames=I),onChange:a.handleChange},{default:t(()=>[o("div",Oo,[e(s,{modelValue:M.value,"onUpdate:modelValue":n[0]||(n[0]=I=>M.value=I),style:ee({width:b.value}),placeholder:"请输入任务名称",onKeyup:n[1]||(n[1]=lt(I=>H(M.value),["enter"]))},{prefix:t(()=>[e(p,{class:"el-input__icon"},{default:t(()=>[e(c(wt))]),_:1})]),_:1},8,["modelValue","style"])]),o("div",No,[e(m,{class:"task-card cursor-pointer animate__animated animate__fadeInLeft",shadow:"hover"},{default:t(()=>[o("div",{onClick:n[2]||(n[2]=I=>U(1))},"我的一天")]),_:1}),e(m,{class:"task-card cursor-pointer animate__animated animate__fadeInLeft",shadow:"hover"},{default:t(()=>[o("div",{onClick:n[3]||(n[3]=I=>U(2))},"全部")]),_:1}),e(m,{class:"task-card cursor-pointer animate__animated animate__fadeInLeft",shadow:"hover"},{default:t(()=>[o("div",{onClick:n[4]||(n[4]=I=>U(3))},"未完成")]),_:1}),e(m,{class:"task-card cursor-pointer animate__animated animate__fadeInLeft",shadow:"hover"},{default:t(()=>[o("div",{onClick:n[5]||(n[5]=I=>U(4))},"已完成")]),_:1}),e(m,{class:"task-card cursor-pointer animate__animated animate__fadeInLeft",shadow:"hover"},{default:t(()=>[o("div",{onClick:n[6]||(n[6]=I=>U(5))},"重要")]),_:1})])]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1},8,["style"])]),_:1}),u.value&&_.value?(T(),X(S,{key:0,span:8,class:"full-height"},{default:t(()=>[e(m,{style:ee([{width:Y.value,height:"100%"},{"max-height":"88vh",overflow:"hidden"}]),class:"animate__animated animate__fadeInLeft"},{default:t(()=>[o("div",Bo,[e(c(pe),{round:"",onClick:K},{default:t(()=>[e(p,null,{default:t(()=>[e(Ee)]),_:1})]),_:1}),e(c(pe),{icon:c(xt),round:"",onClick:n[8]||(n[8]=I=>h.value=!0)},null,8,["icon"]),e(c(pe),{round:"",onClick:n[9]||(n[9]=I=>(_.value=!1,h.value=!1))},{default:t(()=>[e(p,null,{default:t(()=>[e(Le)]),_:1})]),_:1})]),Ue(e(Ze,{description:"现在还没有任务，快点击上方加号创建任务吧",class:"animate__animated animate__fadeInLeft"},null,512),[[Fe,!i.length]]),e(O,{style:{"max-height":"86vh","overflow-y":"auto"}},{default:t(()=>[(T(!0),G(fe,null,ve(i,I=>(T(),G("div",{class:"my-10 task-item w-[100%] animate__animated animate__fadeInLeft",key:I.id},[o("div",Mo,[e(m,{class:"task-card",style:ee({width:P.value,height:"100%"}),onClick:te=>oe(I),shadow:"hover"},{default:t(()=>[o("div",Wo,Z(I.task_name),1),o("div",{class:"flex",style:ee({marginLeft:h.value?"-2.76%":"-1.2%"})},[e(c(pt),{modelValue:I.end_time,"onUpdate:modelValue":te=>I.end_time=te,type:"datetime",placeholder:"设置截止时间",shortcuts:we,onChange:te=>R(I)},null,8,["modelValue","onUpdate:modelValue","onChange"])],4)]),_:2},1032,["style","onClick"]),e(c(Be),{trigger:"click",placement:"bottom-end",class:"w-auto"},{dropdown:t(()=>[e(c(Me),null,{default:t(()=>[e(c(xe),{onClick:te=>a.markAsCompleted(I)},{default:t(()=>[q("标记为已完成")]),_:2},1032,["onClick"]),e(c(xe),{onClick:te=>a.markAsCompleted(I)},{default:t(()=>[q("标记为重要")]),_:2},1032,["onClick"]),e(c(xe),{divided:"",onClick:te=>(Q(I,c(C).kind),h.value=!1)},{default:t(()=>[q("删除任务")]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[e(c(pe),{type:"text",icon:"MoreFilled",style:{border:"none","box-shadow":"none","margin-left":"10px"}})]),_:2},1024)])]))),128))]),_:1})]),_:1},8,["style"])]),_:1})):de("",!0),u.value&&h.value?(T(),X(S,{key:1,span:10,class:"full-height"},{default:t(()=>[e(m,{style:ee({width:E.value}),class:"animate__animated animate__fadeInLeft"},{default:t(()=>[o("div",jo,[e(c(pe),{round:"",onClick:n[10]||(n[10]=I=>h.value=!h.value)},{default:t(()=>[e(p,null,{default:t(()=>[e(Le)]),_:1})]),_:1})]),e(O,{style:{"max-height":"86vh","overflow-y":"auto"}},{default:t(()=>[e(v,null,{default:t(()=>[e(ot,{name:"1"},{title:t(()=>[e(s,{placeholder:"输入标题",modelValue:F.value.task_name,"onUpdate:modelValue":n[13]||(n[13]=I=>F.value.task_name=I),onInput:se,style:{"font-size":"18px"},class:"editable-title my-10"},{prefix:t(()=>[e(Oe,{"model-value":c(f).taskStatus[F.value.id],"onUpdate:modelValue":n[11]||(n[11]=I=>c(f).setTaskStatus(F.value.id,I)),onChange:n[12]||(n[12]=I=>N(F.value)),size:"large"},null,8,["model-value"])]),_:1},8,["modelValue"]),e(p,{onClick:n[14]||(n[14]=rt(I=>w(F.value),["stop"])),style:{cursor:"pointer",border:"none",boxShadow:"none",padding:"0",width:"28px",height:"28px",display:"inline-flex",alignItems:"center",justifyContent:"center"},class:"star-icon"},{default:t(()=>[c(g).stars[F.value.id]?(T(),X(et,{key:0,style:{color:"gold"}})):(T(),X(tt,{key:1,style:{width:"18px",height:"18px"}}))]),_:1})]),default:t(()=>[(T(!0),G(fe,null,ve(A.values,I=>(T(),G("div",{key:I.id},[e(s,{placeholder:"输入内容",modelValue:I.content,"onUpdate:modelValue":te=>I.content=te,onInput:z},{prefix:t(()=>[e(Oe,{"model-value":c(y).stepsStatus[I.id],"onUpdate:modelValue":te=>c(y).setStepStatus(I.id,te),size:"large",onChange:te=>L(I)},null,8,["model-value","onUpdate:modelValue","onChange"])]),append:t(()=>[e(c(Be),{placement:"bottom-end"},{dropdown:t(()=>[e(c(Me),null,{default:t(()=>[e(c(xe),{onClick:te=>a.markAsCompleted(I)},{default:t(()=>[q("标记为已完成")]),_:2},1032,["onClick"]),e(c(xe),{divided:"",onClick:te=>le(I)},{default:t(()=>[q("删除步骤")]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[e(c(pe),{type:"text",icon:"MoreFilled",style:{border:"none","box-shadow":"none"}})]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128)),e(c(pe),{onClick:ne,style:{"margin-top":"10%",border:"none"}},{default:t(()=>[e(p,null,{default:t(()=>[e(Ee)]),_:1}),Ko]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})):de("",!0)]),_:1})}}},je=re(Ho,[["__scopeId","data-v-86ed5f30"]]),qo={class:"charts-container"},Yo={__name:"data",setup(r){const d=_e("axios"),k=Ce(),{isCollapse:y}=be(k),g=$(window.innerWidth),f=$({}),C=$(null),W=$(null),M=$(null),i=$(null),j=B(),x=ae([]),D=[1,2,3,3,4,5,6].reduce((R,a)=>R+a,0),Y=J(()=>g.value>=880),E=J(()=>g.value>880?"100%":"250%"),P=R=>{const a=R/D*100;return a<5?"#c6e2ff":a<10?"#d1edc4":a<15?"#95d475":a<25?"#eebe77":a<35?"#f89898":"#c45656"},b=()=>{g.value=window.innerWidth,y.value=window.innerWidth<880,oe()},h=()=>{const R=f.value.allFinishedTasksCount,a=f.value.allTasksCount-f.value.allFinishedTasksCount;return{title:{text:"任务完成情况",left:"center"},tooltip:{trigger:"item"},series:[{name:"任务分类",type:"pie",radius:"50%",data:[{value:R,name:"已完成任务"},{value:a,name:"未完成任务"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},_=()=>{(he(C.value)||Ie(C.value)).setOption(h(),!0)},U=()=>{const R=f.value.avgProcessOfUnfinishedTasks,a=f.value.stepCompletionRate,n=f.value.taskCompletionRate;return{title:{text:"任务统计",left:"center"},tooltip:{},legend:{data:["Rates"],top:"bottom"},radar:{center:["50%","55%"],indicator:[{name:"任务完成率",max:1},{name:"未完成任务平均进度",max:1},{name:"步骤完成率",max:1}]},series:[{name:"任务完成情况",type:"radar",data:[{value:[n,R,a],name:"Rate",itemStyle:{color:"#1eb84a"},areaStyle:{color:"rgba(140, 255, 152, 0.7)"}}]}]}},K=()=>{(he(W.value)||Ie(W.value)).setOption(U(),!0)},Q=()=>{(he(i.value)||Ie(i.value)).setOption(U(),!0)},F=()=>{const R=Ne(x);return console.log(R),{title:{text:"周任务数量峰值总览"},tooltip:{},xAxis:{data:["周一","周二","周三","周四","周五","周六","周日"]},yAxis:{type:"value",min:0,max:"dataMax"},series:[{name:"任务数量",type:"bar",data:R.map(a=>({value:a,itemStyle:{color:P(a)}}))}]}},A=()=>{(he(M.value)||Ie(M.value)).setOption(F(),!0)},oe=()=>{[C,W,M,i].forEach(R=>{if(R.value){const a=he(R.value);a&&a.resize()}})};ce(()=>{window.addEventListener("resize",b)}),Ve(()=>{window.removeEventListener("resize",b),[C,W,M,i].forEach(R=>{if(R.value){const a=he(R.value);a&&It(a)}})});const se=async()=>{const a=B().token;try{d.get("/task/getTaskCountByWeek",{headers:{Authorization:a}}).then(n=>{console.log(n.data.info);const p=Object.values(n.data.info);x.splice(0,x.length,...p),console.log("Updated weekValue:",Ne(x)),A()})}catch{}},z=$(0),ne=$e(z,{duration:1500,transition:ze.ease}),le=$(0),L=$e(le,{duration:1500,transition:ze.ease}),w=$(0),N=$e(w,{duration:1500,transition:ze.ease}),H=$(0),we=$e(H,{duration:1500,transition:ze.ease});return ce(async()=>{const R=await Qe(j,d);f.value=R,await se(),A(),_(),K(),Q(),A(),setTimeout(()=>{z.value=f.value.allTasksCount,le.value=f.value.allFinishedTasksCount,w.value=f.value.allStepsCount,H.value=f.value.allFinishedStepsCount},500)}),(R,a)=>{const n=l("el-card"),p=l("el-col"),s=l("el-row");return T(),G("div",null,[e(n,{style:{"margin-bottom":"20px"},class:"animate__animated animate__fadeInDown"},{default:t(()=>[e(s,{gutter:20},{default:t(()=>[e(p,{span:6},{default:t(()=>[e(n,{shadow:"never",style:{border:"none"},class:"animate__animated animate__fadeInDown"},{default:t(()=>[e(c(Se),{title:"总任务数",value:c(ne)},null,8,["value"])]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(n,{shadow:"never",style:{border:"none"},class:"animate__animated animate__fadeInDown"},{default:t(()=>[e(c(Se),{title:"任务完成数",value:c(L)},null,8,["value"])]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(n,{shadow:"never",style:{border:"none"},class:"animate__animated animate__fadeInDown"},{default:t(()=>[e(c(Se),{title:"总步骤数",value:c(N)},null,8,["value"])]),_:1})]),_:1}),e(p,{span:6},{default:t(()=>[e(n,{shadow:"never",style:{border:"none"},class:"animate__animated animate__fadeInDown"},{default:t(()=>[e(c(Se),{title:"步骤完成数",value:c(we)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),o("div",qo,[e(s,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(p,{span:10},{default:t(()=>[e(n,{style:ee({width:E.value,"margin-right":"auto"}),class:"animate__animated animate__fadeInDown"},{default:t(()=>[o("div",{ref_key:"chartContainer1",ref:C,class:"chart"},null,512)]),_:1},8,["style"])]),_:1}),Ue(e(p,{span:14},{default:t(()=>[e(n,{class:"animate__animated animate__fadeInDown"},{default:t(()=>[o("div",{ref_key:"chartContainer2",ref:W,class:"chart"},null,512)]),_:1})]),_:1},512),[[Fe,Y.value]])]),_:1}),e(s,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[Ue(e(p,{span:24},{default:t(()=>[e(n,{class:"animate__animated animate__fadeInDown"},{default:t(()=>[o("div",{ref_key:"chartContainer4",ref:i,class:"chart",style:{width:"100%",height:"400px"}},null,512)]),_:1})]),_:1},512),[[Fe,!Y.value]])]),_:1}),e(s,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(p,{span:24},{default:t(()=>[e(n,{class:"animate__animated animate__fadeInDown"},{default:t(()=>[o("div",{ref_key:"chartContainer3",ref:M,class:"chart",style:{width:"100%",height:"400px"}},null,512)]),_:1})]),_:1})]),_:1})])])}}},Ke=re(Yo,[["__scopeId","data-v-96a87f96"]]),ie=r=>(ge("data-v-d793e422"),r=r(),ke(),r),Go=ie(()=>o("div",{class:"font-bold mb-xs",style:{"font-size":"18px"}},"头像修改",-1)),Qo=["src"],Jo=ie(()=>o("div",{class:"font-bold mb-xs",style:{"font-size":"18px"}},"基本信息",-1)),Xo={class:"flex justify-end w-full"},Zo=ie(()=>o("div",{class:"font-bold mb-xs",style:{"font-size":"18px"}},"更改密码",-1)),ea={class:"flex justify-end w-full"},ta=ie(()=>o("div",{class:"font-bold mb-xs",style:{"font-size":"18px"}},"关于我们",-1)),oa=ie(()=>o("div",{class:"about-us-content"}," 于--组长，全栈工程师，任务协调者，文档编写者--潇 ",-1)),aa=ie(()=>o("div",{class:"about-us-content"}," 全栈工程师 ",-1)),sa=ie(()=>o("div",{class:"about-us-content"}," 全栈工程师 ",-1)),na=ie(()=>o("div",{class:"about-us-content"}," 全栈工程师 ",-1)),la=ie(()=>o("div",{class:"about-us-content"}," 全栈工程师 ",-1)),ra={__name:"settings",setup(r){const d=$(0),k=$(null),y=$(null),g=$(!0),f=_e("axios"),C=Ce(),W=$(null),M=B(),i=Te(),{isCollapse:j}=be(C),x=$(null),u=$(null),D=$(null),Y=$("/api/user/uploadPic"),E=ae({nickname:""}),b=ae({nickname:[{validator:(L,w,N)=>{if(w==="")N(new Error("请输入新的昵称"));else{if(E.nickname!==""){if(!u.value)return;u.value.validateField("nickname")}N()}},trigger:"blur"}]}),h=async L=>{if(!L){V({type:"error",message:"表单提交错误，请刷新页面重试。"});return}if(await L.validate().catch(()=>!1)){console.log("submit!");const N=M.token;console.log(N),console.log(E),f.patch("/user/updateNickname",E,{headers:{Authorization:N}}).then(H=>{console.log(H.data),H.data.code?(console.log(H.data.message),V({type:"error",message:"修改失败：请确保新昵称与旧昵称没有重复"})):V({type:"success",message:"修改成功!"})}).catch(H=>{V({type:"error",message:`修改失败: ${H.message}`})})}else console.log("error submit!"),V({type:"error",message:"请确保填写的信息完整无误"})},_=ae({userId:"",verifyCode:"",pass:"",checkPass:""}),F=ae({verifyCode:[{validator:(L,w,N)=>{if(w==="")N(new Error("请输入验证码"));else{if(_.checkPass!==""){if(!x.value)return;x.value.validateField("checkPass")}N()}},trigger:"blur"}],pass:[{validator:(L,w,N)=>{if(w==="")N(new Error("请输入新密码"));else{if(_.checkPass!==""){if(!x.value)return;x.value.validateField("checkPass")}N()}},trigger:"blur"}],checkPass:[{validator:(L,w,N)=>{w===""?N(new Error("请再次输入新密码")):w!==_.pass?N(new Error("请确保两次输入的密码相同")):N()},trigger:"blur"}]}),A=()=>{if(!g.value){V({type:"info",message:"请稍候，正在冷却中..."});return}console.log("发送验证码给:",_.userId),f.post(`/user/getUpdatePwdCode?userId=${encodeURIComponent(_.userId)}`).then(L=>{d.value=120,g.value=!1;const w=setInterval(()=>{d.value--,d.value<=0&&(clearInterval(w),g.value=!0)},1e3);V({type:"success",message:"验证码已发送，请查收！"})}).catch(L=>{V({type:"error",message:`发送失败: ${L.message}`})})},oe=async L=>{if(!L){V({type:"error",message:"表单提交错误，请刷新页面重试。"});return}if(await L.validate().catch(()=>!1)){console.log("submit!");const N=M.token;console.log(N),console.log(_),f.put("/user/newUpdatePwd",_,{headers:{Authorization:N}}).then(H=>{console.log(H.data),H.data.code?(console.log(H.data.message),V({type:"error",message:"请确保验证码填写正确"})):(V({type:"success",message:"修改成功！请重新登录"}),i.push("/login"))}).catch(H=>{V({type:"error",message:`修改失败: ${H.message}`})})}else console.log("error submit!"),V({type:"error",message:"请确保填写的信息完整无误"})},se=async(L,w)=>{if(console.log(L),!L.code)D.value=L.info,V({type:"success",message:"修改成功"});else throw V({type:"error",message:"修改失败"}),new error("上传图片错误")},z=L=>L.type!=="image/jpeg"&&L.type!=="image/png"?(V.error("Avatar picture must be JPG or PNG format!"),!1):L.size/1024/1024>4?(V.error("Avatar picture size can not exceed 4MB!"),!1):!0;ce(async()=>{const L=B();try{const w=await Ge(L,f);k.value=w.user_name,y.value=w.nickname,W.value=w.user_pic,_.userId=k.value,E.nickname=y.value}catch(w){console.error("获取用户信息失败:",w)}});const ne=()=>{le.value=window.innerWidth,j.value=window.innerWidth<1024},le=$(window.innerWidth);return ce(()=>{window.addEventListener("resize",ne)}),Ve(()=>{window.removeEventListener("resize",ne)}),J(()=>le.value>1024),(L,w)=>{const N=l("el-divider"),H=l("el-avatar"),we=l("el-upload"),R=l("el-popover"),a=l("el-form-item"),n=l("el-form"),p=l("el-card"),s=l("el-col"),m=l("el-row"),v=l("el-input"),O=l("el-button");return T(),G(fe,null,[o("div",{class:"flex text-2xl font-bold w-max mt-2 animate__animated animate__fadeInDown",style:ee({"margin-left":c(j)?"20px":"0px",transition:"margin-left .75s ease"})}," 账户信息 ",4),e(N),e(m,null,{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"config-all animate__animated animate__fadeInDown",shadow:"always"},{header:t(()=>[Go]),default:t(()=>[e(n,null,{default:t(()=>[e(a,{style:{"margin-left":"10%"},label:"头像",prop:"avatar"},{default:t(()=>[e(R,{placement:"right-start",width:"auto",trigger:"hover","auto-close":"1000",content:"点击此处更换头像QAQ"},{reference:t(()=>[e(we,{class:"avatar-uploader",action:Y.value,headers:{Authorization:c(M).token},"show-file-list":!1,"on-success":se,"before-upload":z,style:{"margin-left":"5%"}},{default:t(()=>[D.value?(T(),G("img",{key:0,src:D.value,class:"avatar"},null,8,Qo)):(T(),X(H,{key:1,src:W.value,class:"avatar-uploader-icon",shape:"square",size:125},null,8,["src"]))]),_:1},8,["action","headers"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"config-all animate__animated animate__fadeInDown",shadow:"always"},{header:t(()=>[Jo]),default:t(()=>[o("div",null,[e(n,{ref_key:"basicInfoFormRef",ref:u,style:{"max-width":"600px","margin-left":"10%"},model:E,rules:b,"label-width":"80px","label-position":"left",class:"register_form mt-5 left-align"},{default:t(()=>[e(a,{label:"昵称",prop:"nickname"},{default:t(()=>[e(v,{size:"large",modelValue:E.nickname,"onUpdate:modelValue":w[0]||(w[0]=S=>E.nickname=S),type:"text",autocomplete:"off",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(a,null,{default:t(()=>[o("div",Xo,[e(O,{type:"primary",onClick:w[1]||(w[1]=S=>h(u.value)),class:"text-sm h-[40px] w-[90px] mt-4 mb-5",color:"#2283e5"},{default:t(()=>[q(" 确认修改 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"config-all animate__animated animate__fadeInDown",shadow:"always"},{header:t(()=>[Zo]),default:t(()=>[o("div",null,[e(n,{ref_key:"passFormRef",ref:x,style:{"max-width":"600px","margin-left":"10%"},model:_,"status-icon":"",rules:F,"label-width":"100px","label-position":"left",class:"register_form mt-5"},{default:t(()=>[e(a,{label:"当前账户",prop:"userId"},{default:t(()=>[e(v,{size:"large",modelValue:_.userId,"onUpdate:modelValue":w[2]||(w[2]=S=>_.userId=S),type:"text",autocomplete:"off",placeholder:k.value,class:"inputbox",disabled:""},null,8,["modelValue","placeholder"])]),_:1}),e(a,{label:"验证码",prop:"verifyCode"},{default:t(()=>[e(v,{size:"large",modelValue:_.verifyCode,"onUpdate:modelValue":w[5]||(w[5]=S=>_.verifyCode=S),type:"text",autocomplete:"off",placeholder:"请输入你的验证码",class:"inputbox-varify"},{append:t(()=>[e(O,{color:"#2283e5",modelValue:_.verifyCode,"onUpdate:modelValue":w[3]||(w[3]=S=>_.verifyCode=S),onClick:w[4]||(w[4]=S=>A(x.value)),class:"varify-button",disabled:!g.value},{default:t(()=>[q(Z(g.value?"获取":` ${d.value} s`),1)]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"新密码",prop:"pass"},{default:t(()=>[e(v,{size:"large",modelValue:_.pass,"onUpdate:modelValue":w[6]||(w[6]=S=>_.pass=S),type:"text",autocomplete:"off",placeholder:"请正确输入你的新密码",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(a,{label:"重复新密码",prop:"checkPass"},{default:t(()=>[e(v,{size:"large",modelValue:_.checkPass,"onUpdate:modelValue":w[7]||(w[7]=S=>_.checkPass=S),type:"text",autocomplete:"off",placeholder:"请再次正确输入你的新密码",class:"inputbox"},null,8,["modelValue"])]),_:1}),e(a,null,{default:t(()=>[o("div",ea,[e(O,{type:"primary",onClick:w[8]||(w[8]=S=>oe(x.value)),class:"text-sm h-[40px] w-[90px] mt-4 mb-5",color:"#2283e5"},{default:t(()=>[q(" 确认修改 ")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"config-all animate__animated animate__fadeInDown",shadow:"always"},{header:t(()=>[ta]),default:t(()=>[o("div",null,[e(n,{style:{"max-width":"600px","margin-left":"10%","font-size":"18px"},"label-width":"20%","label-position":"left "},{default:t(()=>[e(a,{label:"于潇"},{default:t(()=>[oa]),_:1}),e(a,{label:"李青阳"},{default:t(()=>[aa]),_:1}),e(a,{label:"于钊京"},{default:t(()=>[sa]),_:1}),e(a,{label:"李某某"},{default:t(()=>[na]),_:1}),e(a,{label:"雪烩梨汁"},{default:t(()=>[la]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})],64)}}},He=re(ra,[["__scopeId","data-v-d793e422"]]),ia=[{path:"/",component:Ft,redirect:"/dashboard",children:[{path:"dashboard",component:Do},{path:"plan",component:je},{path:"data",component:Ke},{path:"settings",component:He}]},{path:"/login",component:Wt},{path:"/register",component:ao},{path:"/plan",name:"Plan",component:je},{path:"/data",name:"Data",component:Ke},{path:"/settings",name:"Settings",component:He},{path:"/:pathMatch(.*)*",name:"NotFound",component:Ht}],Je=Ct({history:St(),routes:ia});Je.beforeEach((r,d)=>{const k=B();return r.path==="/login"||r.path==="/register"||k.token?!0:"/login"});const da=qe.create({baseURL:"/api"}),ye=it(At),Xe=dt();Xe.use(ct);ye.provide("axios",da);ye.use(Xe);ye.use(Je);ye.use(ft,{locale:_t});for(const[r,d]of Object.entries(bt))ye.component(r,d);ye.mount("#app");
